\documentclass[../main.tex]{subfiles}

\begin{document}
    \section{Mixture of Gaussian(Soft Clustering)}
        Give probabilities that an instance belongs to each cluster instead of assigning only one. Let $g(x;m,\sigma)$ be the probability of a point $x$ based on a Gaussian Distribution with mean $m$ and variance $\sigma$. Suppose there is a distribution generated by randomly selecting one of $K$ Gaussians. We randomly draw a point from this distribution. Let $p_k$ be the probability of choosing the $k^\mathrm{th}$ Gaussian. Then
        \[
            p(x)=\sum_{k=1}^Kp_kg(x;m_k,\sigma_k)
        \]
        Now we want to find $p_k$, $\sigma_k$ and $m_k$ that maximize $p(x)$.\\
        E step: compute the probability that point $x_n$ is generated by distribution $k$, $i$ stands for steps
        \[
            p^{(i)}(k|x_n)=\frac{p^{(i)}_kg(x_n;m^{(i)}_k,\sigma^{(i)}_k)}{\sum_{j=1}^Kp^{(i)}_jg(x_n;m^{(i)}_j,\sigma^{(i)}_j)}
        \]
        M step: update $p_k$, $\sigma_k$ and $m_k$.
        \begin{align*}
            &m_k^{(i+1)} = \frac{\sum_{n=1}^Np^{(i)}(k|x_n)x_n}{\sum_{n=1}^Np^{(i)}(k|x_n)}\\
            &\sigma^{(i+1)}_k = \sqrt{\frac{\sum_{n=1}^Np^{(i)}(k|x_n)\|x_n-n^{(i+1)}_k\|^2}{\sum_{n=1}^Np^{(i)}(k|x_n)}}\\
            &p^{(i+1)}_k=\frac{1}{N}\sum_{n=1}^Np^{(i)}(k|x_n)
        \end{align*}
\end{document}