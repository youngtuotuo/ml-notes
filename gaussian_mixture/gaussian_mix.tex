\documentclass{article}
\usepackage[a4paper]{geometry}
\usepackage[utf8]{inputenc} 
\usepackage{indentfirst}
%list code
\usepackage{listings}
%content include references
\usepackage[nottoc,numbib]{tocbibind}
% table of contents clickabel
\usepackage{hyperref}
% make file system neat and easier to manage
\usepackage{subfiles}
% packages
\usepackage{csquotes}
\usepackage{arydshln}
\usepackage{dsfont}
\usepackage{polynom}
\usepackage{empheq}
\usepackage{calc}  
\usepackage{enumitem}
\usepackage{graphicx}
\usepackage{systeme}
\usepackage{mathtools}
\usepackage{tikz}
\usepackage{amsfonts, mathrsfs, bm, amsmath, amssymb, bbm, amsthm}
\usepackage{ifthen}
\usepackage{enumerate}
% Make the preview part more eye friendly
\usepackage{xcolor}
\pagecolor[rgb]{1,1,1} % background
\color[rgb]{0,0,0} % foreground
% new command
\DeclareMathOperator*{\argmax}{arg~max}
\DeclareMathOperator*{\argmin}{arg~min}
% theorem block
\newtheorem{theorem}{Theorem}[section]
\newtheorem{note}{Note}
% cross page equation
\allowdisplaybreaks

\begin{document}
    \section{Mixture of Gaussian(Soft Clustering)}
        Give probabilities that an instance belongs to each cluster instead of assigning only one. Let $g(x;m,\sigma)$ be the probability of a point $x$ based on a Gaussian Distribution with mean $m$ and variance $\sigma$. Suppose there is a distribution generated by randomly selecting one of $K$ Gaussians. We randomly draw a point from this distribution. Let $p_k$ be the probability of choosing the $k^\mathrm{th}$ Gaussian. Then
        \[
            p(x)=\sum_{k=1}^Kp_kg(x;m_k,\sigma_k)
        \]
        Now we want to find $p_k$, $\sigma_k$ and $m_k$ that maximize $p(x)$.\\
        E step: compute the probability that point $x_n$ is generated by distribution $k$, $i$ stands for steps
        \[
            p^{(i)}(k|x_n)=\frac{p^{(i)}_kg(x_n;m^{(i)}_k,\sigma^{(i)}_k)}{\sum_{j=1}^Kp^{(i)}_jg(x_n;m^{(i)}_j,\sigma^{(i)}_j)}
        \]
        M step: update $p_k$, $\sigma_k$ and $m_k$.
        \begin{align*}
            &m_k^{(i+1)} = \frac{\sum_{n=1}^Np^{(i)}(k|x_n)x_n}{\sum_{n=1}^Np^{(i)}(k|x_n)}\\
            &\sigma^{(i+1)}_k = \sqrt{\frac{\sum_{n=1}^Np^{(i)}(k|x_n)\|x_n-n^{(i+1)}_k\|^2}{\sum_{n=1}^Np^{(i)}(k|x_n)}}\\
            &p^{(i+1)}_k=\frac{1}{N}\sum_{n=1}^Np^{(i)}(k|x_n)
        \end{align*}
\end{document}
